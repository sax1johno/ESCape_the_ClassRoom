(()=>{var t={93:(t,e,n)=>{"use strict";n.r(e);var r=function(t){if("undefined"!=typeof window){var e=function(){var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:void 0;if(t.__xstate__)return t.__xstate__}();e&&e.register(t)}},i=["_nodes","tags","machine","getMeta","toJSON","can","hasTag","matches"],o=["_nodes","tags","machine","children","context","can","hasTag","matches","getMeta","toJSON"];function a(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function s(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=h(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function c(t){return function(t){if(Array.isArray(t))return d(t)}(t)||u(t)||h(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function l(t,e){return v(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(t,e)||h(t,e)||f()}function f(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(t,e){if(t){if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function v(t){if(Array.isArray(t))return t}function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){g(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function g(t,e,n){return(e=w(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function S(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,w(r.key),r)}}function _(t,e,n){return e&&S(t.prototype,e),n&&S(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function w(t){var e=function(t,e){if("object"!=m(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==m(e)?e:String(e)}var O=function(){function t(e){b(this,t),this._process=e,this._active=!1,this._current=null,this._last=null}return _(t,[{key:"start",value:function(){this._active=!0,this.flush()}},{key:"clear",value:function(){this._current&&(this._current.next=null,this._last=this._current)}},{key:"enqueue",value:function(t){var e={value:t,next:null};if(this._current)return this._last.next=e,void(this._last=e);this._current=e,this._last=e,this._active&&this.flush()}},{key:"flush",value:function(){for(;this._current;){var t=this._current;this._process(t.value),this._current=t.next}this._last=null}}]),t}(),x=".",j="",E="xstate.init",k="xstate.stop";function P(t,e){return{type:"xstate.done.state.".concat(t),output:e}}function A(t){return{type:E,input:t}}function I(t){setTimeout((function(){throw t}))}var T="function"==typeof Symbol&&Symbol.observable||"@@observable";function D(t,e){return"".concat(t.sessionId,".").concat(e)}var M=0;function z(t,e){var n=N(t),r=N(e);return"string"==typeof r?"string"==typeof n&&r===n:"string"==typeof n?n in r:Object.keys(n).every((function(t){return t in r&&z(n[t],r[t])}))}function R(t){if(L(t))return t;for(var e=[],n="",r=0;r<t.length;r++){switch(t.charCodeAt(r)){case 92:n+=t[r+1],r++;continue;case 46:e.push(n),n="";continue}n+=t[r]}return e.push(n),e}function N(t){return(e=t)&&"object"===m(e)&&"machine"in e&&"value"in e?t.value:"string"!=typeof t?t:function(t){if(1===t.length)return t[0];for(var e={},n=e,r=0;r<t.length-1;r++)if(r===t.length-2)n[t[r]]=t[r+1];else{var i=n;n={},i[t[r]]=n}return e}(R(t));var e}function C(t,e){for(var n={},r=Object.keys(t),i=0;i<r.length;i++){var o=r[i];n[o]=e(t[o],o,t,i)}return n}function F(t){return L(t)?t:[t]}function J(t){return void 0===t?[]:F(t)}function q(t,e,n,r){return"function"==typeof t?t({context:e,event:n,self:r}):t}function L(t){return Array.isArray(t)}function V(t){return F(t).map((function(t){return void 0===t||"string"==typeof t?{target:t}:t}))}function B(t){if(void 0!==t&&t!==j)return J(t)}function H(t,e,n){var r,i,o,a="object"===m(t),s=a?t:void 0;return{next:null===(r=a?t.next:t)||void 0===r?void 0:r.bind(s),error:null===(i=a?t.error:e)||void 0===i?void 0:i.bind(s),complete:null===(o=a?t.complete:n)||void 0===o?void 0:o.bind(s)}}function $(t,e){return"".concat(e,".").concat(t)}function U(t,e){var n=e.match(/^xstate\.invoke\.(\d+)\.(.*)/);if(!n)return t.implementations.actors[e];var r=l(n,3),i=r[1],o=r[2],a=t.getStateNodeById(o).config.invoke;return(Array.isArray(a)?a[i]:a).src}var W=function(t){return t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped",t}({}),G={clock:{setTimeout:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){return setTimeout(t,e)})),clearTimeout:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){return clearTimeout(t)}))},logger:console.log.bind(console),devTools:!1},Q=function(){function t(e,n){var r,i,o=this;b(this,t),this.logic=e,this._snapshot=void 0,this.clock=void 0,this.options=void 0,this.id=void 0,this.mailbox=new O(this._process.bind(this)),this.observers=new Set,this.eventListeners=new Map,this.logger=void 0,this._processingStatus=W.NotStarted,this._parent=void 0,this._syncSnapshot=void 0,this.ref=void 0,this._actorScope=void 0,this._systemId=void 0,this.sessionId=void 0,this.system=void 0,this._doneEvent=void 0,this.src=void 0,this._deferred=[];var a=y(y({},G),n),s=a.clock,c=a.logger,u=a.parent,l=a.syncSnapshot,f=a.id,h=a.systemId,d=a.inspect;this.system=u?u.system:function(t,e){var n,r=new Map,i=new Map,o=new WeakMap,a=new Set,s={},c=e.clock,u={schedule:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Math.random().toString(36).slice(2),o={source:t,target:e,event:n,delay:r,id:i,startedAt:Date.now()},a=D(t,i);l._snapshot._scheduledEvents[a]=o;var u=c.setTimeout((function(){delete s[a],delete l._snapshot._scheduledEvents[a],l._relay(t,e,n)}),r);s[a]=u},cancel:function(t,e){var n=D(t,e),r=s[n];delete s[n],delete l._snapshot._scheduledEvents[n],c.clearTimeout(r)},cancelAll:function(t){for(var e in l._snapshot._scheduledEvents){var n=l._snapshot._scheduledEvents[e];n.source===t&&u.cancel(t,n.id)}}},l={_snapshot:{_scheduledEvents:null!==(n=(null==e?void 0:e.snapshot)&&e.snapshot.scheduler)&&void 0!==n?n:{}},_bookId:function(){return"x:".concat(M++)},_register:function(t,e){return r.set(t,e),t},_unregister:function(t){r.delete(t.sessionId);var e=o.get(t);void 0!==e&&(i.delete(e),o.delete(t))},get:function(t){return i.get(t)},_set:function(t,e){var n=i.get(t);if(n&&n!==e)throw new Error("Actor with system ID '".concat(t,"' already exists."));i.set(t,e),o.set(e,t)},inspect:function(t){a.add(t)},_sendInspectionEvent:function(e){if(a.size){var n=y(y({},e),{},{rootId:t.sessionId});a.forEach((function(t){var e;return null===(e=t.next)||void 0===e?void 0:e.call(t,n)}))}},_relay:function(t,e,n){l._sendInspectionEvent({type:"@xstate.event",sourceRef:t,actorRef:e,event:n}),e._send(n)},scheduler:u,getSnapshot:function(){return{_scheduledEvents:y({},l._snapshot._scheduledEvents)}},start:function(){var t=l._snapshot._scheduledEvents;for(var e in l._snapshot._scheduledEvents={},t){var n=t[e],r=n.source,i=n.target,o=n.event,a=n.delay,s=n.id;u.schedule(r,i,o,a,s)}}};return l}(this,{clock:s}),d&&!u&&this.system.inspect(H(d)),this.sessionId=this.system._bookId(),this.id=null!=f?f:this.sessionId,this.logger=c,this.clock=s,this._parent=u,this._syncSnapshot=l,this.options=a,this.src=null!==(r=a.src)&&void 0!==r?r:e,this.ref=this,this._actorScope={self:this,id:this.id,sessionId:this.sessionId,logger:this.logger,defer:function(t){o._deferred.push(t)},system:this.system,stopChild:function(t){if(t._parent!==o)throw new Error("Cannot stop child actor ".concat(t.id," of ").concat(o.id," because it is not a child"));t._stop()},emit:function(t){var e=o.eventListeners.get(t.type);if(e)for(var n=0,r=Array.from(e);n<r.length;n++)(0,r[n])(t)}},this.send=this.send.bind(this),this.system._sendInspectionEvent({type:"@xstate.actor",actorRef:this}),h&&(this._systemId=h,this.system._set(h,this)),this._initState(null!==(i=null==n?void 0:n.snapshot)&&void 0!==i?i:null==n?void 0:n.state),h&&"active"!==this._snapshot.status&&this.system._unregister(this)}return _(t,[{key:"_initState",value:function(t){try{var e;this._snapshot=t?this.logic.restoreSnapshot?this.logic.restoreSnapshot(t,this._actorScope):t:this.logic.getInitialSnapshot(this._actorScope,null===(e=this.options)||void 0===e?void 0:e.input)}catch(t){this._snapshot={status:"error",output:void 0,error:t}}}},{key:"update",value:function(t,e){var n,r,i;for(this._snapshot=t;n=this._deferred.shift();)try{n()}catch(e){this._deferred.length=0,this._snapshot=y(y({},t),{},{status:"error",error:e})}switch(this._snapshot.status){case"active":var o,a=s(this.observers);try{for(a.s();!(o=a.n()).done;){var c=o.value;try{var u;null===(u=c.next)||void 0===u||u.call(c,t)}catch(t){I(t)}}}catch(t){a.e(t)}finally{a.f()}break;case"done":var l,f=s(this.observers);try{for(f.s();!(l=f.n()).done;){var h=l.value;try{var d;null===(d=h.next)||void 0===d||d.call(h,t)}catch(t){I(t)}}}catch(t){f.e(t)}finally{f.f()}this._stopProcedure(),this._complete(),this._doneEvent=(r=this.id,i=this._snapshot.output,{type:"xstate.done.actor.".concat(r),output:i}),this._parent&&this.system._relay(this,this._parent,this._doneEvent);break;case"error":this._error(this._snapshot.error)}this.system._sendInspectionEvent({type:"@xstate.snapshot",actorRef:this,event:e,snapshot:t})}},{key:"subscribe",value:function(t,e,n){var r=this,i=H(t,e,n);if(this._processingStatus!==W.Stopped)this.observers.add(i);else switch(this._snapshot.status){case"done":try{var o;null===(o=i.complete)||void 0===o||o.call(i)}catch(a){I(a)}break;case"error":var a=this._snapshot.error;if(i.error)try{i.error(a)}catch(a){I(a)}else I(a)}return{unsubscribe:function(){r.observers.delete(i)}}}},{key:"on",value:function(t,e){var n=this.eventListeners.get(t);n||(n=new Set,this.eventListeners.set(t,n));var r=e.bind(void 0);return n.add(r),{unsubscribe:function(){n.delete(r)}}}},{key:"start",value:function(){var t=this;if(this._processingStatus===W.Running)return this;this._syncSnapshot&&this.subscribe({next:function(e){"active"===e.status&&t.system._relay(t,t._parent,{type:"xstate.snapshot.".concat(t.id),snapshot:e})},error:function(){}}),this.system._register(this.sessionId,this),this._systemId&&this.system._set(this._systemId,this),this._processingStatus=W.Running;var e=A(this.options.input);switch(this.system._sendInspectionEvent({type:"@xstate.event",sourceRef:this._parent,actorRef:this,event:e}),this._snapshot.status){case"done":return this.update(this._snapshot,e),this;case"error":return this._error(this._snapshot.error),this}if(this._parent||this.system.start(),this.logic.start)try{this.logic.start(this._snapshot,this._actorScope)}catch(t){return this._snapshot=y(y({},this._snapshot),{},{status:"error",error:t}),this._error(t),this}return this.update(this._snapshot,e),this.options.devTools&&this.attachDevTools(),this.mailbox.start(),this}},{key:"_process",value:function(t){var e,n;try{e=this.logic.transition(this._snapshot,t,this._actorScope)}catch(r){n={err:r}}if(n){var r=n.err;return this._snapshot=y(y({},this._snapshot),{},{status:"error",error:r}),void this._error(r)}this.update(e,t),t.type===k&&(this._stopProcedure(),this._complete())}},{key:"_stop",value:function(){return this._processingStatus===W.Stopped?this:(this.mailbox.clear(),this._processingStatus===W.NotStarted?(this._processingStatus=W.Stopped,this):(this.mailbox.enqueue({type:k}),this))}},{key:"stop",value:function(){if(this._parent)throw new Error("A non-root actor cannot be stopped directly.");return this._stop()}},{key:"_complete",value:function(){var t,e=s(this.observers);try{for(e.s();!(t=e.n()).done;){var n=t.value;try{var r;null===(r=n.complete)||void 0===r||r.call(n)}catch(t){I(t)}}}catch(t){e.e(t)}finally{e.f()}this.observers.clear()}},{key:"_reportError",value:function(t){if(this.observers.size){var e,n=!1,r=s(this.observers);try{for(r.s();!(e=r.n()).done;){var i=e.value.error;n||(n=!i);try{null==i||i(t)}catch(t){I(t)}}}catch(t){r.e(t)}finally{r.f()}this.observers.clear(),n&&I(t)}else this._parent||I(t)}},{key:"_error",value:function(t){var e,n;this._stopProcedure(),this._reportError(t),this._parent&&this.system._relay(this,this._parent,(e=this.id,n=t,{type:"xstate.error.actor.".concat(e),error:n}))}},{key:"_stopProcedure",value:function(){return this._processingStatus!==W.Running||(this.system.scheduler.cancelAll(this),this.mailbox.clear(),this.mailbox=new O(this._process.bind(this)),this._processingStatus=W.Stopped,this.system._unregister(this)),this}},{key:"_send",value:function(t){this._processingStatus!==W.Stopped&&this.mailbox.enqueue(t)}},{key:"send",value:function(t){this.system._relay(void 0,this,t)}},{key:"attachDevTools",value:function(){var t=this.options.devTools;t&&("function"==typeof t?t:r)(this)}},{key:"toJSON",value:function(){return{xstate$$type:1,id:this.id}}},{key:"getPersistedSnapshot",value:function(t){return this.logic.getPersistedSnapshot(this._snapshot,t)}},{key:T,value:function(){return this}},{key:"getSnapshot",value:function(){return this._snapshot}}]),t}();function K(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=n[0];return new Q(t,i)}function X(t,e,n,r,i){var o=i.sendId;return[e,"function"==typeof o?o(n,r):o]}function Y(t,e){t.defer((function(){t.system.scheduler.cancel(t.self,e)}))}function Z(t,e,n,r,i){var o,a=i.id,s=i.systemId,c=i.src,u=i.input,l=i.syncSnapshot,f="string"==typeof c?U(e.machine,c):c,h="function"==typeof a?a(n):a;return f&&(o=K(f,{id:h,src:c,parent:t.self,syncSnapshot:l,systemId:s,input:"function"==typeof u?u({context:e.context,event:n.event,self:t.self}):u})),[Gt(e,{children:y(y({},e.children),{},g({},h,o))}),{id:a,actorRef:o}]}function tt(t,e){e.id;var n=e.actorRef;n&&t.defer((function(){n._processingStatus!==W.Stopped&&n.start()}))}function et(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[0],i=e[1],o=void 0===i?{}:i,a=o.id,s=o.systemId,c=o.input,u=o.syncSnapshot,l=void 0!==u&&u;function f(t,e){}return f.type="snapshot.spawnChild",f.id=a,f.systemId=s,f.src=r,f.input=c,f.syncSnapshot=l,f.resolve=Z,f.execute=tt,f}function nt(t,e,n,r,i){var o=i.actorRef,a="function"==typeof o?o(n,r):o,s="string"==typeof a?e.children[a]:a,c=e.children;return s&&delete(c=y({},c))[s.id],[Gt(e,{children:c}),s]}function rt(t,e){e&&(t.system._unregister(e),e._processingStatus===W.Running?t.defer((function(){t.stopChild(e)})):t.stopChild(e))}function it(t){function e(t,e){}return e.type="xstate.stopChild",e.actorRef=t,e.resolve=nt,e.execute=rt,e}function ot(t,e,n,r){var i=r.machine,o="function"==typeof t,a=o?t:i.implementations.guards["string"==typeof t?t:t.type];if(!o&&!a)throw new Error("Guard '".concat("string"==typeof t?t:t.type,"' is not implemented.'."));if("function"!=typeof a)return ot(a,e,n,r);var s={context:e,event:n},c=o||"string"==typeof t?void 0:"params"in t?"function"==typeof t.params?t.params({context:e,event:n}):t.params:void 0;return"check"in a?a.check(r,s,a):a(s,c)}var at=function(t){return"atomic"===t.type||"final"===t.type};function st(t){return Object.values(t.states).filter((function(t){return"history"!==t.type}))}function ct(t,e){var n=[];if(e===t)return n;for(var r=t.parent;r&&r!==e;)n.push(r),r=r.parent;return n}function ut(t){var e,n=new Set(t),r=ft(n),i=s(n);try{for(i.s();!(e=i.n()).done;){var o=e.value;if("compound"!==o.type||r.get(o)&&r.get(o).length){if("parallel"===o.type){var a,c=s(st(o));try{for(c.s();!(a=c.n()).done;){var u=a.value;if("history"!==u.type&&!n.has(u)){var l,f=s(bt(u));try{for(f.s();!(l=f.n()).done;){var h=l.value;n.add(h)}}catch(t){f.e(t)}finally{f.f()}}}}catch(t){c.e(t)}finally{c.f()}}}else bt(o).forEach((function(t){return n.add(t)}))}}catch(t){i.e(t)}finally{i.f()}var d,v=s(n);try{for(v.s();!(d=v.n()).done;)for(var p=d.value.parent;p;)n.add(p),p=p.parent}catch(t){v.e(t)}finally{v.f()}return n}function lt(t,e){var n=e.get(t);if(!n)return{};if("compound"===t.type){var r=n[0];if(!r)return{};if(at(r))return r.key}var i,o={},a=s(n);try{for(a.s();!(i=a.n()).done;){var c=i.value;o[c.key]=lt(c,e)}}catch(t){a.e(t)}finally{a.f()}return o}function ft(t){var e,n=new Map,r=s(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;n.has(i)||n.set(i,[]),i.parent&&(n.has(i.parent)||n.set(i.parent,[]),n.get(i.parent).push(i))}}catch(t){r.e(t)}finally{r.f()}return n}function ht(t,e){return lt(t,ft(ut(e)))}function dt(t,e){return"compound"===e.type?st(e).some((function(e){return"final"===e.type&&t.has(e)})):"parallel"===e.type?st(e).every((function(e){return dt(t,e)})):"final"===e.type}var vt=function(t){return"#"===t[0]};function pt(t){var e=t.config.after;if(!e)return[];return Object.keys(e).flatMap((function(n,r){var i=e[n],o="string"==typeof i?{target:i}:i,a=Number.isNaN(+n)?n:+n,s=function(e,n){var r,i,o=(r=e,i=t.id,{type:"xstate.after.".concat(r,".").concat(i)}),a=o.type;return t.entry.push(function(t,e){function n(t,e){}return n.type="xstate.raise",n.event=t,n.id=null==e?void 0:e.id,n.delay=null==e?void 0:e.delay,n.resolve=Kt,n.execute=Xt,n}(o,{id:a,delay:e})),t.exit.push(function(t){function e(t,e){}return e.type="xstate.cancel",e.sendId=t,e.resolve=X,e.execute=Y,e}(a)),a}(a);return J(o).map((function(t){return y(y({},t),{},{event:s,delay:a})}))})).map((function(e){var n=e.delay;return y(y({},yt(t,e.event,e)),{},{delay:n})}))}function yt(t,e,n){var r,i=B(n.target),o=null!==(r=n.reenter)&&void 0!==r&&r,a=function(t,e){if(void 0!==e)return e.map((function(e){if("string"!=typeof e)return e;if(vt(e))return t.machine.getStateNodeById(e);var n=e[0]===x;if(n&&!t.parent)return wt(t,e.slice(1));var r=n?t.key+e:e;if(!t.parent)throw new Error('Invalid target: "'.concat(e,'" is not a valid target from the root node. Did you mean ".').concat(e,'"?'));try{return wt(t.parent,r)}catch(e){throw new Error("Invalid transition definition for state node '".concat(t.id,"':\n").concat(e.message))}}))}(t,i),s=y(y({},n),{},{actions:J(n.actions),guard:n.guard,target:a,source:t,reenter:o,eventType:e,toJSON:function(){return y(y({},s),{},{source:"#".concat(t.id),target:a?a.map((function(t){return"#".concat(t.id)})):void 0})}});return s}function gt(t){var e=B(t.config.target);return e?{target:e.map((function(e){return"string"==typeof e?wt(t.parent,e):e}))}:t.parent.initial}function mt(t){return"history"===t.type}function bt(t){var e,n=St(t),r=s(n);try{for(r.s();!(e=r.n()).done;){var i,o=s(ct(e.value,t));try{for(o.s();!(i=o.n()).done;){var a=i.value;n.add(a)}}catch(t){o.e(t)}finally{o.f()}}}catch(t){r.e(t)}finally{r.f()}return n}function St(t){var e=new Set;return function t(n){if(!e.has(n))if(e.add(n),"compound"===n.type)t(n.initial.target[0]);else if("parallel"===n.type){var r,i=s(st(n));try{for(i.s();!(r=i.n()).done;)t(r.value)}catch(t){i.e(t)}finally{i.f()}}}(t),e}function _t(t,e){if(vt(e))return t.machine.getStateNodeById(e);if(!t.states)throw new Error("Unable to retrieve child state '".concat(e,"' from '").concat(t.id,"'; no child states exist."));var n=t.states[e];if(!n)throw new Error("Child state '".concat(e,"' does not exist on '").concat(t.id,"'"));return n}function wt(t,e){if("string"==typeof e&&vt(e))try{return t.machine.getStateNodeById(e)}catch(t){}for(var n=R(e).slice(),r=t;n.length;){var i=n.shift();if(!i.length)break;r=_t(r,i)}return r}function Ot(t,e){if("string"==typeof e){var n=t.states[e];if(!n)throw new Error("State '".concat(e,"' does not exist on '").concat(t.id,"'"));return[t,n]}var r=Object.keys(e),i=r.map((function(e){return _t(t,e)})).filter(Boolean);return[t.machine.root,t].concat(i,r.reduce((function(n,r){var i=_t(t,r);if(!i)return n;var o=Ot(i,e[r]);return n.concat(o)}),[]))}function xt(t,e,n,r){return"string"==typeof e?function(t,e,n,r){var i=_t(t,e).next(n,r);return i&&i.length?i:t.next(n,r)}(t,e,n,r):1===Object.keys(e).length?function(t,e,n,r){var i=Object.keys(e),o=xt(_t(t,i[0]),e[i[0]],n,r);return o&&o.length?o:t.next(n,r)}(t,e,n,r):function(t,e,n,r){for(var i=[],o=0,a=Object.keys(e);o<a.length;o++){var s=a[o],u=e[s];if(u){var l=xt(_t(t,s),u,n,r);l&&i.push.apply(i,c(l))}}return i.length?i:t.next(n,r)}(t,e,n,r)}function jt(t,e){for(var n=t;n.parent&&n.parent!==e;)n=n.parent;return n.parent===e}function Et(t,e){var n,r=new Set(t),i=new Set(e),o=s(r);try{for(o.s();!(n=o.n()).done;){var a=n.value;if(i.has(a))return!0}}catch(t){o.e(t)}finally{o.f()}var c,u=s(i);try{for(u.s();!(c=u.n()).done;){var l=c.value;if(r.has(l))return!0}}catch(t){u.e(t)}finally{u.f()}return!1}function kt(t,e,n){var r,i=new Set,o=s(t);try{for(o.s();!(r=o.n()).done;){var a,c=r.value,u=!1,l=new Set,f=s(i);try{for(f.s();!(a=f.n()).done;){var h=a.value;if(Et(It([c],e,n),It([h],e,n))){if(!jt(c.source,h.source)){u=!0;break}l.add(h)}}}catch(t){f.e(t)}finally{f.f()}if(!u){var d,v=s(l);try{for(v.s();!(d=v.n()).done;){var p=d.value;i.delete(p)}}catch(t){v.e(t)}finally{v.f()}i.add(c)}}}catch(t){o.e(t)}finally{o.f()}return Array.from(i)}function Pt(t,e){if(!t.target)return[];var n,r=new Set,i=s(t.target);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(mt(o))if(e[o.id]){var a,u=s(e[o.id]);try{for(u.s();!(a=u.n()).done;){var l=a.value;r.add(l)}}catch(t){u.e(t)}finally{u.f()}}else{var f,h=s(Pt(gt(o),e));try{for(h.s();!(f=h.n()).done;){var d=f.value;r.add(d)}}catch(t){h.e(t)}finally{h.f()}}else r.add(o)}}catch(t){i.e(t)}finally{i.f()}return c(r)}function At(t,e){var n=Pt(t,e);if(n){if(!t.reenter&&n.every((function(e){return e===t.source||jt(e,t.source)})))return t.source;var r=function(t){var e,n,r=v(e=t)||u(e)||h(e)||f(),i=r[0],o=r.slice(1),a=s(ct(i,void 0));try{var c,l=function(){var t=n.value;if(o.every((function(e){return jt(e,t)})))return{v:t}};for(a.s();!(n=a.n()).done;)if(c=l())return c.v}catch(t){a.e(t)}finally{a.f()}}(n.concat(t.source));if(r)return r;if(!t.reenter)return t.source.machine.root}}function It(t,e,n){var r,i=new Set,o=s(t);try{for(o.s();!(r=o.n()).done;){var a,u=r.value;if(null!==(a=u.target)&&void 0!==a&&a.length){var l=At(u,n);u.reenter&&u.source===l&&i.add(l);var f,h=s(e);try{for(h.s();!(f=h.n()).done;){var d=f.value;jt(d,l)&&i.add(d)}}catch(t){h.e(t)}finally{h.f()}}}}catch(t){o.e(t)}finally{o.f()}return c(i)}function Tt(t,e,n,r,i,o){if(!t.length)return e;var a=new Set(e._nodes),u=e.historyValue,f=kt(t,a,u),h=e;if(!i){var d=function(t,e,n,r,i,o,a){var u,l=t,f=It(r,i,o);f.sort((function(t,e){return e.order-t.order}));var h,d=s(f);try{var v=function(){var t,e,n=h.value,r=s((e=n,Object.keys(e.states).map((function(t){return e.states[t]})).filter((function(t){return"history"===t.type}))));try{for(r.s();!(t=r.n()).done;){var a,c,l=t.value;c="deep"===l.history?function(t){return at(t)&&jt(t,n)}:function(t){return t.parent===n},null!==(a=u)&&void 0!==a||(u=y({},o)),u[l.id]=Array.from(i).filter(c)}}catch(t){r.e(t)}finally{r.f()}};for(d.s();!(h=d.n()).done;)v()}catch(t){d.e(t)}finally{d.f()}var p,g=s(f);try{for(g.s();!(p=g.n()).done;){var m=p.value;l=Ct(l,e,n,[].concat(c(m.exit),c(m.invoke.map((function(t){return it(t.id)})))),a),i.delete(m)}}catch(t){g.e(t)}finally{g.f()}return[l,u||o]}(h,r,n,f,a,u,o),v=l(d,2);h=v[0],u=v[1]}h=function(t,e,n,r,i,o,a,u){var l=t,f=new Set,h=new Set;(function(t,e,n,r){var i,o=s(t);try{for(o.s();!(i=o.n()).done;){var a,c=i.value,u=At(c,e),l=s(c.target||[]);try{for(l.s();!(a=l.n()).done;){var f=a.value;mt(f)||c.source===f&&c.source===u&&!c.reenter||(r.add(f),n.add(f)),Mt(f,e,n,r)}}catch(t){l.e(t)}finally{l.f()}var h,d=s(Pt(c,e));try{for(d.s();!(h=d.n()).done;){var v=ct(h.value,u);"parallel"===(null==u?void 0:u.type)&&v.push(u),zt(r,e,n,v,!c.source.parent&&c.reenter?void 0:u)}}catch(t){d.e(t)}finally{d.f()}}}catch(t){o.e(t)}finally{o.f()}})(r,a,h,f),u&&h.add(t.machine.root);var d,v=new Set,p=s(c(f).sort((function(t,e){return t.order-e.order})));try{for(p.s();!(d=p.n()).done;){var g=d.value;i.add(g);var m=[];m.push.apply(m,c(g.entry));var b,S=s(g.invoke);try{for(S.s();!(b=S.n()).done;){var _=b.value;m.push(et(_.src,y(y({},_),{},{syncSnapshot:!!_.onSnapshot})))}}catch(t){S.e(t)}finally{S.f()}if(h.has(g)){var w=g.initial.actions;m.push.apply(m,c(w))}if(l=Ct(l,e,n,m,o,g.invoke.map((function(t){return t.id}))),"final"===g.type){var O=g.parent,x="parallel"===(null==O?void 0:O.type)?O:null==O?void 0:O.parent,j=x||g;for("compound"===(null==O?void 0:O.type)&&o.push(P(O.id,void 0!==g.output?q(g.output,l.context,e,n.self):void 0));"parallel"===(null===(E=x)||void 0===E?void 0:E.type)&&!v.has(x)&&dt(i,x);){var E;v.add(x),o.push(P(x.id)),j=x,x=x.parent}if(x)continue;l=Gt(l,{status:"done",output:Dt(l,e,n,l.machine.root,j)})}}}catch(t){p.e(t)}finally{p.f()}return l}(h=Ct(h,r,n,f.flatMap((function(t){return t.actions})),o),r,n,f,a,o,u,i);var p=c(a);"done"===h.status&&(h=Ct(h,r,n,p.sort((function(t,e){return e.order-t.order})).flatMap((function(t){return t.exit})),o));try{return u===e.historyValue&&function(t,e){if(t.length!==e.size)return!1;var n,r=s(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!e.has(i))return!1}}catch(t){r.e(t)}finally{r.f()}return!0}(e._nodes,a)?h:Gt(h,{_nodes:p,historyValue:u})}catch(t){throw t}}function Dt(t,e,n,r,i){if(void 0!==r.output){var o=P(i.id,void 0!==i.output&&i.parent?q(i.output,t.context,e,n.self):void 0);return q(r.output,t.context,o,n.self)}}function Mt(t,e,n,r){if(mt(t))if(e[t.id]){var i,o=e[t.id],a=s(o);try{for(a.s();!(i=a.n()).done;){var u=i.value;r.add(u),Mt(u,e,n,r)}}catch(t){a.e(t)}finally{a.f()}var f,h=s(o);try{for(h.s();!(f=h.n()).done;)Rt(f.value,t.parent,r,e,n)}catch(t){h.e(t)}finally{h.f()}}else{var d,v=gt(t),p=s(v.target);try{for(p.s();!(d=p.n()).done;){var y,g=d.value;r.add(g),v===(null===(y=t.parent)||void 0===y?void 0:y.initial)&&n.add(t.parent),Mt(g,e,n,r)}}catch(t){p.e(t)}finally{p.f()}var m,b=s(v.target);try{for(b.s();!(m=b.n()).done;)Rt(m.value,t.parent,r,e,n)}catch(t){b.e(t)}finally{b.f()}}else if("compound"===t.type){var S=l(t.initial.target,1)[0];mt(S)||(r.add(S),n.add(S)),Mt(S,e,n,r),Rt(S,t,r,e,n)}else if("parallel"===t.type){var _,w=s(st(t).filter((function(t){return!mt(t)})));try{var O=function(){var t=_.value;c(r).some((function(e){return jt(e,t)}))||(mt(t)||(r.add(t),n.add(t)),Mt(t,e,n,r))};for(w.s();!(_=w.n()).done;)O()}catch(t){w.e(t)}finally{w.f()}}}function zt(t,e,n,r,i){var o,a=s(r);try{for(a.s();!(o=a.n()).done;){var u=o.value;if(i&&!jt(u,i)||t.add(u),"parallel"===u.type){var l,f=s(st(u).filter((function(t){return!mt(t)})));try{var h=function(){var r=l.value;c(t).some((function(t){return jt(t,r)}))||(t.add(r),Mt(r,e,n,t))};for(f.s();!(l=f.n()).done;)h()}catch(t){f.e(t)}finally{f.f()}}}}catch(t){a.e(t)}finally{a.f()}}function Rt(t,e,n,r,i){zt(n,r,i,ct(t,e))}function Nt(t,e,n,r,i,o){var a,c=t.machine,u=t,f=s(r);try{var h=function(){var t=a.value,r="function"==typeof t,s=r?t:c.implementations.actions["string"==typeof t?t:t.type];if(!s)return 0;var f={context:u.context,event:e,self:n.self,system:n.system},h=r||"string"==typeof t?void 0:"params"in t?"function"==typeof t.params?t.params({context:u.context,event:e}):t.params:void 0;function d(){n.system._sendInspectionEvent({type:"@xstate.action",actorRef:n.self,action:{type:"string"==typeof t?t:"object"===m(t)?t.type:t.name||"(anonymous)",params:h}}),s(f,h)}if(!("resolve"in s))return n.self._processingStatus===W.Running?d():n.defer((function(){d()})),0;var v=s,p=l(v.resolve(n,u,f,h,s,i),3),y=p[0],g=p[1],b=p[2];u=y,"retryResolve"in v&&(null==o||o.push([v,g])),"execute"in v&&(n.self._processingStatus===W.Running?v.execute(n,g):n.defer(v.execute.bind(null,n,g))),b&&(u=Nt(u,e,n,b,i,o))};for(f.s();!(a=f.n()).done;)h()}catch(t){f.e(t)}finally{f.f()}return u}function Ct(t,e,n,r,i,o){var a=o?[]:void 0,s=Nt(t,e,n,r,{internalQueue:i,deferredActorIds:o},a);return null==a||a.forEach((function(t){var e=l(t,2),r=e[0],i=e[1];r.retryResolve(n,s,i)})),s}function Ft(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=t,o=[];function a(t,e,r){n.system._sendInspectionEvent({type:"@xstate.microstep",actorRef:n.self,event:e,snapshot:t,_transitions:r}),o.push(t)}if(e.type===k)return a(i=Gt(Jt(i,e,n),{status:"stopped"}),e,[]),{snapshot:i,microstates:o};var s=e;if(s.type!==E){var c=s,u=function(t){return t.type.startsWith("xstate.error.actor")}(c),l=qt(c,i);if(u&&!l.length)return a(i=Gt(t,{status:"error",error:c.error}),c,[]),{snapshot:i,microstates:o};a(i=Tt(l,t,n,s,!1,r),c,l)}for(var f=!0;"active"===i.status;){var h=f?Lt(i,s):[],d=h.length?i:void 0;if(!h.length){if(!r.length)break;h=qt(s=r.shift(),i)}f=(i=Tt(h,i,n,s,!1,r))!==d,a(i,s,h)}return"active"!==i.status&&Jt(i,s,n),{snapshot:i,microstates:o}}function Jt(t,e,n){return Ct(t,e,n,Object.values(t.children).map((function(t){return it(t)})),[])}function qt(t,e){return e.machine.getTransitionData(e,t)}function Lt(t,e){var n,r=new Set,i=s(t._nodes.filter(at));try{for(i.s();!(n=i.n()).done;){var o,a=n.value,c=s([a].concat(ct(a,void 0)));try{t:for(c.s();!(o=c.n()).done;){var u=o.value;if(u.always){var l,f=s(u.always);try{for(f.s();!(l=f.n()).done;){var h=l.value;if(void 0===h.guard||ot(h.guard,t.context,e,t)){r.add(h);break t}}}catch(t){f.e(t)}finally{f.f()}}}}catch(t){c.e(t)}finally{c.f()}}}catch(t){i.e(t)}finally{i.f()}return kt(Array.from(r),new Set(t._nodes),t.historyValue)}var Vt=function(t){return z(t,this.value)},Bt=function(t){return this.tags.has(t)},Ht=function(t){var e=this.machine.getTransitionData(this,t);return!(null==e||!e.length)&&e.some((function(t){return void 0!==t.target||t.actions.length}))},$t=function(){this._nodes;var t=this.tags;return this.machine,this.getMeta,this.toJSON,this.can,this.hasTag,this.matches,y(y({},a(this,i)),{},{tags:Array.from(t)})},Ut=function(){return this._nodes.reduce((function(t,e){return void 0!==e.meta&&(t[e.id]=e.meta),t}),{})};function Wt(t,e){return{status:t.status,output:t.output,error:t.error,machine:e,context:t.context,_nodes:t._nodes,value:ht(e.root,t._nodes),tags:new Set(t._nodes.flatMap((function(t){return t.tags}))),children:t.children,historyValue:t.historyValue||{},matches:Vt,hasTag:Bt,can:Ht,getMeta:Ut,toJSON:$t}}function Gt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Wt(y(y({},t),e),t.machine)}function Qt(t){var e,n;for(var r in t){var i=t[r];if(i&&"object"===m(i))if("sessionId"in i&&"send"in i&&"ref"in i){var o;null!==(o=n)&&void 0!==o||(n=Array.isArray(t)?t.slice():y({},t)),n[r]={xstate$$type:1,id:i.id}}else{var a,s=Qt(i);s!==i&&(null!==(a=n)&&void 0!==a||(n=Array.isArray(t)?t.slice():y({},t)),n[r]=s)}}return null!==(e=n)&&void 0!==e?e:t}function Kt(t,e,n,r,i,o){var a=i.event,s=i.id,c=i.delay,u=o.internalQueue,l=e.machine.implementations.delays;if("string"==typeof a)throw new Error('Only event objects may be used with raise; use raise({ type: "'.concat(a,'" }) instead'));var f,h="function"==typeof a?a(n,r):a;if("string"==typeof c){var d=l&&l[c];f="function"==typeof d?d(n,r):d}else f="function"==typeof c?c(n,r):c;return"number"!=typeof f&&u.push(h),[e,{event:h,id:s,delay:f}]}function Xt(t,e){var n=e.event,r=e.delay,i=e.id;"number"!=typeof r||t.defer((function(){var e=t.self;t.system.scheduler.schedule(e,e,n,r,i)}))}function Yt(t){return Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yt(t)}function Zt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function te(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Zt(Object(n),!0).forEach((function(e){var r,i,o,a;r=t,i=e,o=n[e],a=function(t,e){if("object"!=Yt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Yt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i),(i="symbol"==Yt(a)?a:String(a))in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ee(t,e,n,r){var i=e.machine,o=e.context;return function(e,a){var s=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=a.systemId,c=a.input;if("string"==typeof e){var u=U(i,e);if(!u)throw new Error("Actor logic '".concat(e,"' not implemented in machine '").concat(i.id,"'"));var l=K(u,{id:a.id,parent:t.self,syncSnapshot:a.syncSnapshot,input:"function"==typeof c?c({context:o,event:n,self:t.self}):c,src:e,systemId:s});return r[l.id]=l,l}return K(e,{id:a.id,parent:t.self,syncSnapshot:a.syncSnapshot,input:a.input,src:e,systemId:s})}(e,a);return r[s.id]=s,t.defer((function(){s._processingStatus!==W.Stopped&&s.start()})),s}}function ne(t,e,n,r,i){var o=i.assignment;if(!e.context)throw new Error("Cannot assign to undefined `context`. Ensure that `context` is defined in the machine config.");var a={},s={context:e.context,event:n.event,spawn:ee(t,e,n.event,a),self:t.self,system:t.system},c={};if("function"==typeof o)c=o(s,r);else for(var u=0,l=Object.keys(o);u<l.length;u++){var f=l[u],h=o[f];c[f]="function"==typeof h?h(s,r):h}return[Gt(e,{context:Object.assign({},e.context,c),children:Object.keys(a).length?te(te({},e.children),a):e.children})]}function re(t){function e(t,e){}return e.type="xstate.assign",e.assignment=t,e.resolve=ne,e}var ie=["onDone","onError"];function oe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ae(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?oe(Object(n),!0).forEach((function(e){se(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function se(t,e,n){return(e=ge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ce(t){return ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ce(t)}function ue(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=he(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function le(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(t,e)||he(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(t){return function(t){if(Array.isArray(t))return de(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||he(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function he(t,e){if(t){if("string"==typeof t)return de(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?de(t,e):void 0}}function de(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ge(r.key),r)}}function ye(t,e,n){return e&&pe(t.prototype,e),n&&pe(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ge(t){var e=function(t,e){if("object"!=ce(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=ce(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ce(e)?e:String(e)}var me=new WeakMap;function be(t,e,n){var r=me.get(t);return r?e in r||(r[e]=n()):(r=se({},e,n()),me.set(t,r)),r[e]}var Se={},_e=function(t){return"string"==typeof t?{type:t}:"function"==typeof t?"resolve"in t?{type:t.type}:{type:t.name}:t},we=function(){function t(e,n){var r=this;if(ve(this,t),this.config=e,this.key=void 0,this.id=void 0,this.type=void 0,this.path=void 0,this.states=void 0,this.history=void 0,this.entry=void 0,this.exit=void 0,this.parent=void 0,this.machine=void 0,this.meta=void 0,this.output=void 0,this.order=-1,this.description=void 0,this.tags=[],this.transitions=void 0,this.always=void 0,this.parent=n._parent,this.key=n._key,this.machine=n._machine,this.path=this.parent?this.parent.path.concat(this.key):[],this.id=this.config.id||[this.machine.id].concat(fe(this.path)).join(x),this.type=this.config.type||(this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.description=this.config.description,this.order=this.machine.idMap.size,this.machine.idMap.set(this.id,this),this.states=this.config.states?C(this.config.states,(function(e,n){return new t(e,{_parent:r,_key:n,_machine:r.machine})})):Se,"compound"===this.type&&!this.config.initial)throw new Error('No initial state specified for compound state node "#'.concat(this.id,'". Try adding { initial: "').concat(Object.keys(this.states)[0],'" } to the state config.'));this.history=!0===this.config.history?"shallow":this.config.history||!1,this.entry=J(this.config.entry).slice(),this.exit=J(this.config.exit).slice(),this.meta=this.config.meta,this.output="final"!==this.type&&this.parent?void 0:this.config.output,this.tags=J(e.tags).slice()}return ye(t,[{key:"_initialize",value:function(){var t=this;this.transitions=function(t){var e=new Map;if(t.config.on)for(var n=function(){var n=i[r];if(""===n)throw new Error('Null events ("") cannot be specified as a transition key. Use `always: { ... }` instead.');var o=t.config.on[n];e.set(n,V(o).map((function(e){return yt(t,n,e)})))},r=0,i=Object.keys(t.config.on);r<i.length;r++)n();if(t.config.onDone){var o="xstate.done.state.".concat(t.id);e.set(o,V(t.config.onDone).map((function(e){return yt(t,o,e)})))}var a,c=s(t.invoke);try{var u=function(){var n=a.value;if(n.onDone){var r="xstate.done.actor.".concat(n.id);e.set(r,V(n.onDone).map((function(e){return yt(t,r,e)})))}if(n.onError){var i="xstate.error.actor.".concat(n.id);e.set(i,V(n.onError).map((function(e){return yt(t,i,e)})))}if(n.onSnapshot){var o="xstate.snapshot.".concat(n.id);e.set(o,V(n.onSnapshot).map((function(e){return yt(t,o,e)})))}};for(c.s();!(a=c.n()).done;)u()}catch(t){c.e(t)}finally{c.f()}var l,f=s(t.after);try{for(f.s();!(l=f.n()).done;){var h=l.value,d=e.get(h.eventType);d||(d=[],e.set(h.eventType,d)),d.push(h)}}catch(t){f.e(t)}finally{f.f()}return e}(this),this.config.always&&(this.always=V(this.config.always).map((function(e){return yt(t,"",e)}))),Object.keys(this.states).forEach((function(e){t.states[e]._initialize()}))}},{key:"definition",get:function(){var t=this;return{id:this.id,key:this.key,version:this.machine.version,type:this.type,initial:this.initial?{target:this.initial.target,source:this,actions:this.initial.actions.map(_e),eventType:null,reenter:!1,toJSON:function(){return{target:t.initial.target.map((function(t){return"#".concat(t.id)})),source:"#".concat(t.id),actions:t.initial.actions.map(_e),eventType:null}}}:void 0,history:this.history,states:C(this.states,(function(t){return t.definition})),on:this.on,transitions:fe(this.transitions.values()).flat().map((function(t){return ae(ae({},t),{},{actions:t.actions.map(_e)})})),entry:this.entry.map(_e),exit:this.exit.map(_e),meta:this.meta,order:this.order||-1,output:this.output,invoke:this.invoke,description:this.description,tags:this.tags}}},{key:"toJSON",value:function(){return this.definition}},{key:"invoke",get:function(){var t=this;return be(this,"invoke",(function(){return J(t.config.invoke).map((function(e,n){var r,i=e.src,o=e.systemId,a=null!==(r=e.id)&&void 0!==r?r:$(t.id,n),s="string"==typeof i?i:"xstate.invoke.".concat($(t.id,n));return ae(ae({},e),{},{src:s,id:a,systemId:o,toJSON:function(){return e.onDone,e.onError,ae(ae({},function(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}(e,ie)),{},{type:"xstate.invoke",src:s,id:a})}})}))}))}},{key:"on",get:function(){var t=this;return be(this,"on",(function(){return fe(t.transitions).flatMap((function(t){var e=le(t,2),n=e[0];return e[1].map((function(t){return[n,t]}))})).reduce((function(t,e){var n=le(e,2),r=n[0],i=n[1];return t[r]=t[r]||[],t[r].push(i),t}),{})}))}},{key:"after",get:function(){var t=this;return be(this,"delayedTransitions",(function(){return pt(t)}))}},{key:"initial",get:function(){var t=this;return be(this,"initial",(function(){return function(t,e){var n="string"==typeof e?t.states[e]:e?t.states[e.target]:void 0;if(!n&&e)throw new Error('Initial state node "'.concat(e,'" not found on parent state node #').concat(t.id));var r={source:t,actions:e&&"string"!=typeof e?J(e.actions):[],eventType:null,reenter:!1,target:n?[n]:[],toJSON:function(){return y(y({},r),{},{source:"#".concat(t.id),target:n?["#".concat(n.id)]:[]})}};return r}(t,t.config.initial)}))}},{key:"next",value:function(t,e){var n,r,i=this,o=e.type,a=[],s=ue(be(this,"candidates-".concat(o),(function(){return e=o,(t=i).transitions.get(e)||c(t.transitions.keys()).filter((function(t){if("*"===t)return!0;if(!t.endsWith(".*"))return!1;for(var n=t.split("."),r=e.split("."),i=0;i<n.length;i++){var o=n[i],a=r[i];if("*"===o)return i===n.length-1;if(o!==a)return!1}return!0})).sort((function(t,e){return e.length-t.length})).flatMap((function(e){return t.transitions.get(e)}));var t,e})));try{for(s.s();!(r=s.n()).done;){var u=r.value,l=u.guard,f=t.context,h=!1;try{h=!l||ot(l,f,e,t)}catch(t){var d="string"==typeof l?l:"object"===ce(l)?l.type:void 0;throw new Error("Unable to evaluate guard ".concat(d?"'".concat(d,"' "):"","in transition for event '").concat(o,"' in state node '").concat(this.id,"':\n").concat(t.message))}if(h){a.push.apply(a,fe(u.actions)),n=u;break}}}catch(t){s.e(t)}finally{s.f()}return n?[n]:void 0}},{key:"events",get:function(){var t=this;return be(this,"events",(function(){var e=t.states,n=new Set(t.ownEvents);if(e)for(var r=0,i=Object.keys(e);r<i.length;r++){var o=e[i[r]];if(o.states){var a,s=ue(o.events);try{for(s.s();!(a=s.n()).done;){var c=a.value;n.add("".concat(c))}}catch(t){s.e(t)}finally{s.f()}}}return Array.from(n)}))}},{key:"ownEvents",get:function(){var t=this,e=new Set(fe(this.transitions.keys()).filter((function(e){return t.transitions.get(e).some((function(t){return!(!t.target&&!t.actions.length&&!t.reenter)}))})));return Array.from(e)}}]),t}(),Oe=function(){function t(e,n){var r,i,o,a;ve(this,t),this.config=e,this.version=void 0,this.schemas=void 0,this.implementations=void 0,this.__xstatenode=!0,this.idMap=new Map,this.root=void 0,this.id=void 0,this.states=void 0,this.events=void 0,this.__TResolvedTypesMeta=void 0,this.id=e.id||"(machine)",this.implementations={actors:null!==(r=null==n?void 0:n.actors)&&void 0!==r?r:{},actions:null!==(i=null==n?void 0:n.actions)&&void 0!==i?i:{},delays:null!==(o=null==n?void 0:n.delays)&&void 0!==o?o:{},guards:null!==(a=null==n?void 0:n.guards)&&void 0!==a?a:{}},this.version=this.config.version,this.schemas=this.config.schemas,this.transition=this.transition.bind(this),this.getInitialSnapshot=this.getInitialSnapshot.bind(this),this.getPersistedSnapshot=this.getPersistedSnapshot.bind(this),this.restoreSnapshot=this.restoreSnapshot.bind(this),this.start=this.start.bind(this),this.root=new we(e,{_key:this.id,_machine:this}),this.root._initialize(),this.states=this.root.states,this.events=this.root.events}return ye(t,[{key:"provide",value:function(e){var n=this.implementations,r=n.actions,i=n.guards,o=n.actors,a=n.delays;return new t(this.config,{actions:ae(ae({},r),e.actions),guards:ae(ae({},i),e.guards),actors:ae(ae({},o),e.actors),delays:ae(ae({},a),e.delays)})}},{key:"resolveState",value:function(t){var e,n=ht(e=this.root,c(ut(Ot(e,t.value)))),r=ut(Ot(this.root,n));return Wt({_nodes:fe(r),context:t.context||{},children:{},status:dt(r,this.root)?"done":t.status||"active",output:t.output,error:t.error,historyValue:t.historyValue},this)}},{key:"transition",value:function(t,e,n){return Ft(t,e,n).snapshot}},{key:"microstep",value:function(t,e,n){return Ft(t,e,n).microstates}},{key:"getTransitionData",value:function(t,e){return xt(this.root,t.value,t,e)||[]}},{key:"getPreInitialState",value:function(t,e,n){var r=this.config.context,i=Wt({context:"function"!=typeof r&&r?r:{},_nodes:[this.root],children:{},status:"active"},this);return"function"==typeof r?Ct(i,e,t,[re((function(t){var e=t.spawn,n=t.event,i=t.self;return r({spawn:e,input:n.input,self:i})}))],n):i}},{key:"getInitialSnapshot",value:function(t,e){var n=A(e),r=[],i=this.getPreInitialState(t,n,r);return Ft(Tt([{target:fe(St(this.root)),source:this.root,reenter:!0,actions:[],eventType:null,toJSON:null}],i,t,n,!0,r),n,t,r).snapshot}},{key:"start",value:function(t){Object.values(t.children).forEach((function(t){"active"===t.getSnapshot().status&&t.start()}))}},{key:"getStateNodeById",value:function(t){var e=R(t),n=e.slice(1),r=vt(e[0])?e[0].slice(1):e[0],i=this.idMap.get(r);if(!i)throw new Error("Child state node '#".concat(r,"' does not exist on machine '").concat(this.id,"'"));return wt(i,n)}},{key:"definition",get:function(){return this.root.definition}},{key:"toJSON",value:function(){return this.definition}},{key:"getPersistedSnapshot",value:function(t,e){return function(t,e){t._nodes,t.tags,t.machine;var n=t.children,r=t.context,i=(t.can,t.hasTag,t.matches,t.getMeta,t.toJSON,a(t,o)),s={};for(var c in n){var u=n[c];s[c]={snapshot:u.getPersistedSnapshot(e),src:u.src,systemId:u._systemId,syncSnapshot:u._syncSnapshot}}return y(y({},i),{},{context:Qt(r),children:s})}(t,e)}},{key:"restoreSnapshot",value:function(t,e){var n=this,r={},i=t.children;Object.keys(i).forEach((function(t){var o=i[t],a=o.snapshot,s=o.src,c="string"==typeof s?U(n,s):s;if(c){var u=K(c,{id:t,parent:e.self,syncSnapshot:o.syncSnapshot,snapshot:a,src:s,systemId:o.systemId});r[t]=u}}));var o=Wt(ae(ae({},t),{},{children:r,_nodes:Array.from(ut(Ot(this.root,t.value)))}),this),a=new Set;return function t(e,n){if(!a.has(e))for(var r in a.add(e),e){var i=e[r];if(i&&"object"===ce(i)){if("xstate$$type"in i&&1===i.xstate$$type){e[r]=n[i.id];continue}t(i,n)}}}(o.context,r),o}}]),t}();const xe=JSON.parse('{"id":"baseGameLoop","initial":"starting","states":{"starting":{"id":"starting","on":{"loaded":"running"}},"running":{"initial":"briefing","onDone":"ended","on":{"pause":"paused","end":"ended"},"states":{"gameOver":{"type":"final"},"hist":{"type":"history","history":"deep"},"briefing":{"id":"briefing","initial":"briefingPlay","states":{"briefingPlay":{"on":{"pause":"briefingPaused","end":"briefingEnd"}},"briefingPaused":{"on":{"resume":"briefingPlay"}},"briefingEnd":{"type":"final"}}},"debriefing":{"id":"debriefing","onDone":"gameOver","initial":"debriefingPlay","states":{"debriefingPlay":{"on":{"pause":"debriefingPaused","end":"debriefingEnd"}},"debriefingPaused":{"on":{"resume":"debriefingPlay"}},"debriefingEnd":{"type":"final"}}}}},"paused":{"on":{"resume":"running.hist","end":"ended"}},"ended":{"type":"final"}}}');function je(t){return je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},je(t)}function Ee(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ke(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ee(Object(n),!0).forEach((function(e){Pe(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Pe(t,e,n){var r;return r=function(t,e){if("object"!=je(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=je(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(e),(e="symbol"==je(r)?r:String(r))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}AFRAME.registerSystem("game-state",{schema:{},init:function(){this.service=null,this.roomElements=[],this.puzzleElements=[],this.actions={},this.gameStateMachineDefinition={},this.manager=null},pause:function(){},play:function(){},addAction:function(t,e){this.actions[t]=e},addActions:function(t){for(var e=Object.keys(t),n=0;n<e.length;n++)this.addAction(e[n],t[e[n]])},addRoom:function(t,e,n){this.roomElements.push({name:t,el:e,onDone:n})},addPuzzle:function(t,e,n,r){this.puzzleElements.push({room:t,name:e,el:n,actions:r})},start:function(){var t,e,n=this;this.gameStateMachine=ke({},xe),this._buildRoomElements(),this._buildPuzzleElements(),this.gameStateMachine.states.running.states=ke(ke({},this.gameStateMachine.states.running.states),this.gameStateMachineDefinition),this.service=K((t=this.gameStateMachine,e={actions:this.actions},new Oe(t,e))),this.service.subscribe((function(t){console.log("Game State Machine Updated",t.value),n.el.emit("game-state-updated",t)})),this.el.addEventListener("game-state-event",(function(t){n.service.send({type:t.detail})})),this.service.start()},_buildRoomElements:function(){this.gameStateMachine.states.running.states.briefing.onDone={target:this.roomElements[0].name};for(var t=0;t<this.roomElements.length;t++)this.gameStateMachineDefinition[this.roomElements[t].name]={id:this.roomElements[t].name,initial:"solving",onDone:{target:this.roomElements[t+1]?this.roomElements[t+1].name:"debriefing",actions:this.roomElements[t].onDone||""},states:{solved:{type:"final"},solving:{type:"parallel",onDone:{target:"solved"},states:{}}}}},_buildPuzzleElements:function(){for(var t=0;t<this.puzzleElements.length;t++)this.gameStateMachineDefinition[this.puzzleElements[t].room].states.solving.states[this.puzzleElements[t].name]={initial:"unsolved",states:{unsolved:{on:Pe({},"".concat(this.puzzleElements[t].name,".solved"),"solved")},solved:{type:"final"}}}}}),AFRAME.registerComponent("remove-on-game-event",{schema:{state:{type:"string",required:!0}},init:function(){var t=this;this.el.sceneEl.addEventListener("game-notify-event",(function(e){e.detail.type==t.data.state&&t.el.remove()}))}}),AFRAME.registerComponent("hide-part-on-game-event",{multiple:!0,schema:{state:{type:"string",required:!0},parts:{default:[]}},init:function(){var t=this;document.querySelector("a-scene").addEventListener("game-notify-event",(function(e){if(console.log(t.data.parts),console.log(t.data.state),e.detail.type==t.data.state){console.log("Game-notify-event in hide-on-game-event",e.detail);for(var n=t.el.components["gltf-model"].model,r=t.data.parts,i=0;i<r.length;i++){var o=n.getObjectByName(r[i]);o&&(o.visible=!1)}}}))}}),AFRAME.registerComponent("animate-on-game-event",{multiple:!0,schema:{state:{type:"string",required:!0},action:{type:"string",required:!0}},init:function(){var t=this;console.log("event = ",this.data.state," and action = ",this.data.action),document.querySelector("a-scene").addEventListener("game-notify-event",(function(e){e.detail.type==t.data.state&&(console.log("Animation on game event triggered by event",e.detail),t.el.setAttribute("animation-mixer",{clip:t.data.action,loop:"once",clampWhenFinished:"true"})),console.log("Animation on game event triggered by event ".concat(JSON.stringify(e.detail)))}))}}),AFRAME.registerComponent("game-state",{schema:{name:{type:"string",required:!0},type:{type:"string",oneOf:["room","puzzle"],required:!0},room:{type:"string",default:""},onDone:{type:"array",default:[]}},init:function(){"room"==this.data.type&&this.system.addRoom(this.data.name,this.el,this.data.onDone),"puzzle"==this.data.type&&this.system.addPuzzle(this.data.room,this.data.name,this.el)}})},435:()=>{AFRAME.registerComponent("gltf-hide",{schema:{parts:{default:[]}},init:function(){var t=this;this.el.addEventListener("model-loaded",(function(){var e=t.el.components["gltf-model"].model,n=t.data.parts;console.log(n);for(var r=0;r<n.length;r++){var i=e.getObjectByName(n[r]);i&&(i.visible=!1)}}))}})},652:()=>{var t={},e={},n={};AFRAME.registerComponent("gltf-part-custom",{schema:{buffer:{default:!0},part:{type:"string"},src:{type:"asset"},keepPosition:{type:"boolean",default:!0}},update:function(){var t=this.el;!this.data.part&&this.data.src||this.getModel((function(e){if(e){t.setObject3D("mesh",e);var r=n[t.getAttribute("gltf-part-custom").part].position,i=n[t.getAttribute("gltf-part-custom").part].rotation;console.log("originalPosition: ".concat(r.x," ").concat(r.y," ").concat(r.z)),console.log("originalRotation: ".concat(i.x," ").concat(i.y," ").concat(i.z,", ").concat(i.w)),t.setAttribute("position","".concat(r.x," ").concat(r.y," ").concat(r.z)),t.setAttribute("rotation","".concat(THREE.MathUtils.radToDeg(i.x)," ").concat(THREE.MathUtils.radToDeg(i.y)," ").concat(THREE.MathUtils.radToDeg(i.z)))}}))},getModel:function(n){var r=this;if(!e[this.data.src])return t[this.data.src]?t[this.data.src].then((function(t){n(r.selectFromModel(t))})):void(t[this.data.src]=new Promise((function(i){(new THREE.GLTFLoader).load(r.data.src,(function(o){var a=o.scene||o.scenes[0];e[r.data.src]=a,delete t[r.data.src],n(r.selectFromModel(a)),i(a)}),(function(){}),console.error)})));n(this.selectFromModel(e[this.data.src]))},selectFromModel:function(t){var e,r;if(r=t.getObjectByName(this.data.part))return e=r.getObjectByProperty("type","Mesh").clone(!0),n[this.data.part]=n[this.data.part]||{},n[this.data.part].position=t.getObjectByName(this.data.part).getWorldPosition(new THREE.Vector3(0,0,0)),n[this.data.part].rotation=t.getObjectByName(this.data.part).rotation,console.log("rotation: ",n[this.data.part].rotation),this.data.buffer?(e.geometry=e.geometry.toNonIndexed(),e):(e.geometry=(new THREE.Geometry).fromBufferGeometry(e.geometry),e);console.error("[gltf-part] `"+this.data.part+"` not found in model.")}})},834:()=>{function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var e,n,r,i,o,a,s,c;AFRAME.registerComponent("simple-navmesh-constraint",{schema:{enabled:{default:!0},navmesh:{default:""},fall:{default:.5},height:{default:1.6},exclude:{default:""},xzOrigin:{default:""}},update:function(){this.lastPosition=null,this.excludes=this.data.exclude?Array.from(document.querySelectorAll(this.data.exclude)):[];var t=Array.from(document.querySelectorAll(this.data.navmesh));null===t?(console.warn("simple-navmesh-constraint: Did not match any elements"),this.objects=[]):this.objects=t.map((function(t){return t.object3D})).concat(this.excludes.map((function(t){return t.object3D}))),this.xzOrigin=this.data.xzOrigin?this.el.querySelector(this.data.xzOrigin):this.el},tick:(e=new THREE.Vector3,n=new THREE.Vector3,r=[[0,1],[0,.5],[30,.4],[-30,.4],[60,.2],[-60,.2],[80,.06],[-80,.06]],i=new THREE.Vector3(0,-1,0),o=new THREE.Raycaster,a=[],s=0,c=!0,function(u,l){if(!1!==this.data.enabled&&(null===this.lastPosition&&(c=!0,this.lastPosition=new THREE.Vector3,this.xzOrigin.object3D.getWorldPosition(this.lastPosition),this.data.xzOrigin&&(this.lastPosition.y-=this.xzOrigin.object3D.position.y)),this.el,0!==this.objects.length&&(this.xzOrigin.object3D.getWorldPosition(e),this.data.xzOrigin&&(e.y-=this.xzOrigin.object3D.position.y),!(e.distanceTo(this.lastPosition)<=.01)))){var f=!1;t:for(var h=0,d=r;h<d.length;h++){var v=(w=2,function(t){if(Array.isArray(t))return t}(_=d[h])||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(_,w)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(_,w)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=v[0],y=v[1];if(n.subVectors(e,this.lastPosition),n.applyAxisAngle(i,p*Math.PI/180),n.multiplyScalar(y),n.add(this.lastPosition),n.y+=.5,n.y-=this.data.height,o.set(n,i),o.far=this.data.fall>0?this.data.fall+.5:1/0,o.intersectObjects(this.objects,!0,a),a.length){for(var g=0,m=a;g<m.length;g++){var b=m[g];if(this.excludes.includes(b.object.el)){a.splice(0);continue t}}var S=a[0].point;a.splice(0),S.y+=this.data.height,e.y-(S.y-2*s)>.01?(s+=Math.max(-1*l*.001,-.5),S.y=e.y+s):s=0,n.copy(S),this.xzOrigin.object3D.parent.worldToLocal(n),n.sub(this.xzOrigin.object3D.position),this.data.xzOrigin&&(n.y+=this.xzOrigin.object3D.position.y),this.el.object3D.position.add(n),this.lastPosition.copy(S),f=!0;break}}f&&(c=!1),c||f||(this.el.object3D.position.copy(this.lastPosition),this.el.object3D.parent.worldToLocal(this.el.object3D.position))}var _,w})})}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n(93),n(834),n(652),n(435)})();